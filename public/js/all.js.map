{"version":3,"sources":["playlist.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"all.js","sourcesContent":["/**\r\n * Created by Henrique Ferreira on 30/07/2016.\r\n */\r\n\r\nvar PlaylistModule = (function () {\r\n    return {\r\n        initAddView: function () {\r\n\r\n            console.log(\"PlaylistModule add init.\");\r\n            var videos = [];\r\n            $('body').on('click', function () {\r\n                $('.search-results').addClass('hidden');\r\n            });\r\n            $('#add_form').on('submit', function () {\r\n                    if ($('input[data-type=\"video_info\"][value=\"\"]').length > 0) {\r\n                        alert('Please fill all the music choices');\r\n                        return false;\r\n                    }\r\n                }\r\n            );\r\n            stop_propgation = function () {\r\n                if (event.stopPropagation) {\r\n                    event.stopPropagation();   // W3C model\r\n                } else {\r\n                    event.cancelBubble = true; // IE model\r\n                }\r\n            };\r\n            select_video = function () {\r\n                var video_id = $(event.srcElement).closest('a').data('video-id');\r\n                var row_id = $(event.srcElement).closest('a').data('id');\r\n                var display_span = $('.video-label[data-id=\"' + row_id + '\"]');\r\n                var input = $('input#name[data-id=\"' + row_id + '\"]');\r\n                var item = videos[video_id];\r\n                console.log($('#videos[' + row_id + '][name]'), $('#videos[' + row_id + '][video_code]'), $('#videos[' + row_id + '][video_url]'));\r\n                $('#videos_' + row_id + '_name').val(item.snippet.title);\r\n                $('#videos_' + row_id + '_video_code').val(item.id);\r\n                $('#videos_' + row_id + '_video_url').val(item.snippet.title);\r\n                input.val('');\r\n                input.removeAttr('required');\r\n                input.attr('disabled', 'true');\r\n                display_span.empty();\r\n\r\n                var template = '<li class=\"list-group-item\" style=\"display: block;\">' +\r\n                    '<div class=\"col-xs-12 col-sm-3\">' +\r\n                    '<img src=\"' + item.snippet.thumbnails.default.url + '\" class=\"img-responsive\">' +\r\n                    '</div>' +\r\n                    '<div class=\"col-xs-12 col-sm-9\">' +\r\n                    '<span class=\"video_name\"><strong>' + item.snippet.title + '</strong></span><br>' +\r\n                    '</div>' +\r\n                    '<div class=\"top-icon\"><a href=\"#\" onclick=\"deleteEntry()\" data-id=\"' + row_id + '\"><i class=\"fa fa-times\"></i> </a> </div>' +\r\n                    '<div class=\"clearfix\"></div>' +\r\n                    '</li>';\r\n                display_span.append(template);\r\n            };\r\n            play_video = function () {\r\n                var video_id = $(event.srcElement).closest('a').data('video-id');\r\n                console.log(\"Play video function: \" + video_id + \" , \" + player);\r\n                function onYouTubeIframeAPIReady() {\r\n                    player = new YT.Player('player', {\r\n                        height: '300',\r\n                        width: '400',\r\n                        events: {\r\n                            'onReady': onPlayerReady,\r\n                            'onStateChange': onPlayerStateChange\r\n                        }\r\n                    });\r\n                }\r\n\r\n                function onPlayerReady(event) {\r\n                    // console.log(player);\r\n                    player.loadVideoById(video_id);\r\n                    // event.target.playVideo();\r\n                }\r\n\r\n                function onPlayerStateChange(event) {\r\n                    // console.log(event.data);\r\n                }\r\n\r\n                if (player !== undefined) {\r\n                    player.loadVideoById(video_id);\r\n                }\r\n                else\r\n                    onYouTubeIframeAPIReady();\r\n\r\n            };\r\n            deleteEntry = function () {\r\n                var row_id = $(event.srcElement).closest('a').data('id');\r\n                var display_span = $('.video-label[data-id=\"' + row_id + '\"]');\r\n                display_span.empty();\r\n                var input = $('input#name[data-id=\"' + row_id + '\"]');\r\n                input.removeAttr('disabled');\r\n                input.attr('required', 'true');\r\n                console.log(\"delete \" + row_id);\r\n                $('#videos_' + row_id + '_name').val(\"\");\r\n                $('#videos_' + row_id + '_video_code').val(\"\");\r\n                $('#videos_' + row_id + '_video_url').val(\"\");\r\n            };\r\n            var timer, delay = 500;\r\n            $('input[data-handler=\"youtube_query\"]').on('keydown blur change', function (e) {\r\n                var _this = $(this);\r\n                clearTimeout(timer);\r\n                timer = setTimeout(function () {\r\n\r\n                    if (_this.val().length > 3) {\r\n                        var id = _this.data('id');\r\n                        console.log('searching for: ' + _this.val());\r\n                        $.ajax({\r\n                            type: 'GET',\r\n                            url: youtubeQueryRoute,\r\n                            data: {\r\n                                query: _this.val()\r\n                            }\r\n                        }).done(function (data) {\r\n                            var ul = $('.search-results[data-id=\"' + id + '\"]');\r\n                            ul.addClass('hidden');\r\n                            ul.empty();\r\n                            data.data.forEach(function (item) {\r\n                                // videos.clear();\r\n                                videos[item.id] = item;\r\n                                // console.log(item);\r\n                                var template = '<li class=\"list-group-item\" style=\"display: block;\">' +\r\n                                    '<div class=\"col-xs-12 col-sm-3\">' +\r\n                                    '<img src=\"' + item.snippet.thumbnails.default.url + '\" class=\"img-responsive\">' +\r\n                                    '</div>' +\r\n                                    '<div class=\"col-xs-12 col-sm-9\">' +\r\n                                    '<span class=\"video_name\"><strong>' + item.snippet.title + '</strong></span><br>' +\r\n                                    '<span class=\"video_duration\">' + item.contentDetails.duration.replace('PT', '').replace('M', ':').replace('H', ':').replace('S', '') + '</span><br>' +\r\n                                    '<span class=\"actions\">' +\r\n                                    '<a href=\"#\" onclick=\"play_video()\" data-id=\"' + id + '\" data-video-id=\"' + item.id + '\"><i class=\"fa fa-play\"></i> Play</a>' +\r\n                                    '<a href=\"#\" onclick=\"select_video()\" data-id=\"' + id + '\" data-video-id=\"' + item.id + '\"><i class=\"fa fa-check\"></i> Select</a>' +\r\n                                    '</span>' +\r\n                                    '<br>' +\r\n                                    '</div>' +\r\n                                    '<div class=\"clearfix\"></div>' +\r\n                                    '</li>';\r\n                                ul.append(template);\r\n                            });\r\n                            // console.log(videos);\r\n                            ul.removeClass('hidden');\r\n                        });\r\n                    }\r\n\r\n                }, delay);\r\n            });\r\n        },\r\n        initPlayView: function () {\r\n            var player;\r\n\r\n            function onYouTubeIframeAPIReady() {\r\n                player = new YT.Player('player', {\r\n                    height: '460',\r\n                    width: '768',\r\n                    events: {\r\n                        'onReady': onPlayerReady,\r\n                        'onStateChange': onPlayerStateChange\r\n                    },\r\n                    iv_load_policy: 3\r\n                });\r\n            }\r\n\r\n            function onPlayerReady(event) {\r\n                event.target.playVideo();\r\n                player.loadPlaylist({\r\n                    'playlist': playlistDB,\r\n                    'listType': 'playlist',\r\n                    'index': 0\r\n                });\r\n            }\r\n\r\n            function onPlayerStateChange(event) {\r\n                if (event.data == YT.PlayerState.ENDED) {\r\n                    event.target.playVideo();\r\n                }\r\n                else if (event.data == YT.PlayerState.BUFFERING) {\r\n                    refreshStatus();\r\n                    checkIfInView();\r\n                }\r\n            }\r\n\r\n            function addActiveClass() {\r\n                $(\".music:first\").addClass(\"active\");\r\n            };\r\n\r\n            $(\".music\").on('click', function () {\r\n                player.loadVideoById($(this).attr(\"data-video-id\"));\r\n                refreshStatus();\r\n            });\r\n            function refreshStatus() {\r\n                $(\".music\").removeClass(\"active\");\r\n                $(\".music[data-video-id='\" + player.getVideoData()[\"video_id\"] + \"']\").addClass(\"active\");\r\n                checkIfInView();\r\n            }\r\n\r\n            $(\".music.active\").mCustomScrollbar();\r\n\r\n            function checkIfInView() {\r\n                var music = $(\".music.active\");\r\n                $('.mCustomScrollbar').mCustomScrollbar(\"scrollTo\", music);\r\n            }\r\n\r\n            onYouTubeIframeAPIReady();\r\n            addActiveClass();\r\n        }\r\n    }\r\n})\r\n();"],"sourceRoot":"/source/"}